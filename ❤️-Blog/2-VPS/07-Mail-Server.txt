å‡†å¤‡å·¥ä½œ:
    ä¸€ä¸ªå¸¦å›ºå®šIPçš„Linux æœåŠ¡å™¨ (è¿™é‡Œæ˜¯CentOS6) 
    ä¸€ä¸ªåŸŸå: www.0214.help


â¤ï¸ é‚®ä»¶æœåŠ¡å™¨æ¶æ„:

ğŸ”µæœåŠ¡ç«¯:
  
    é‚®ä»¶æœåŠ¡å™¨: éœ€è¦å¤šä¸ªè½¯ä»¶äº’ç›¸é…åˆæ‰èƒ½æ­å»ºä¸€å¥—å®Œæ•´çš„é‚®ä»¶æœåŠ¡å™¨.
    
    ğŸ“Œ ç»å…¸æ­é…: Postfix + devocot + cyrus-sasl(å®‰å…¨éªŒè¯)
        Postfix: æœåŠ¡å™¨ä¸Šæ”¶å‘æ‰€æœ‰ç”¨æˆ·çš„é‚®ä»¶
        devocot: æŠŠæœåŠ¡å™¨ä¸Šæ”¶åˆ°é‚®ä»¶è½¬å‘ç»™æŸå°ç”µè„‘(æŸäºº)


    ğŸ”¸Sendmailã€Postfix ä¼ è¾“é‚®ä»¶(å‘é€å’Œæ¥æ”¶)
            Postfixå®ç°äº†emailçš„æ¥æ”¶ã€è·¯ç”±ä»¥åŠå‘é€ç­‰çš„æ ¸å¿ƒåŠŸèƒ½.ä½†å®ƒåŒæ—¶ä¹Ÿä¾èµ–ç¬¬ä¸‰æ–¹è½¯ä»¶æ¥å®Œæˆå…¶ä»–çš„å·¥ä½œã€‚
            ä¼ è¾“ä¸åŒ…æ‹¬ä¿å­˜. æŠŠæ¥æ”¶åˆ°çš„é‚®ä»¶ä¿å­˜åˆ°æœ¬åœ°ç¡¬ç›˜æ˜¯ procmail çš„äº‹æƒ….
          
    ğŸ”¸Dovecot  é‚®ä»¶æ¥æ”¶ä»£ç†
            å’Œå®¢æˆ·ç«¯äº¤äº’. æŠŠæœåŠ¡å™¨ä¸Šçš„é‚®ä»¶é€šè¿‡IMAPæˆ–POP3åè®®ä¼ è¾“ç»™å®¢æˆ·ç«¯ã€‚

    ğŸ”¸cyrus-sasl
        SASL Simple Authentication Security Layer
        ç®€å•è®¤è¯å®‰å…¨å±‚,åŠŸèƒ½ä¸»è¦æ˜¯ç”¨äºSMTPè®¤è¯ã€‚ 
        Cyrus SASL æ˜¯ SASL çš„ä¸€ä¸ªå®ç°.

        å…¨ä¸–ç•ŒèŒƒå›´å†…çš„SMTPæœåŠ¡å™¨ä¸æ—¥ä¿±å¢ï¼Œä½†æ˜¯è¿™äº›SMTPæœåŠ¡å™¨éƒ½æœ‰ä¸€ä¸ªä¸ç”Ÿä¿±æ¥çš„ç¼ºç‚¹ï¼Œé‚£å°±æ˜¯æ²¡æœ‰ä»»ä½•çš„è®¤è¯æœºåˆ¶ã€‚ 
            æ­£æ˜¯å› ä¸ºSMTPé€šè®¯è¿‡ç¨‹ç¼ºä¹è®¤è¯æœºåˆ¶ï¼Œä»¥åŠipæ¬ºéª—çš„å®¹æ˜“å®ç°ï¼Œå¯¼è‡´äº†ä»¥ä¸‹ä¸¤ä¸ªæ–¹é¢çš„é—®é¢˜ï¼š
            SMTPæœåŠ¡å™¨æ— æ³•ç¡®è®¤SMTPå®¢æˆ·æœºçš„åˆæ³•æ€§ï¼›
            SMTPå®¢æˆ·æœºä¹Ÿæ— æ³•ç¡®è®¤SMTPæœåŠ¡å™¨çš„åˆæ³•æ€§ã€‚
            ä»è€Œä¹Ÿå°±å¯¼è‡´äº†ç”¨æˆ·å¯ä»¥ä¸ç»è¿‡è®¤è¯å°±å‘é€é‚®ä»¶ï¼Œç”¨æˆ·å¯ä»¥å†’åå‘é€é‚®ä»¶ï¼Œä»¥åŠåƒåœ¾é‚®ä»¶çš„æ³›æ»¥ã€‚



ğŸ”µ å®¢æˆ·ç«¯

        å®¢æˆ·ç«¯ ä¸‹è½½æœåŠ¡å™¨ä¸Šçš„é‚®ä»¶æœ‰ä¸¤ç§æ–¹å¼: IMAP(143) å’Œ POP3(110)
        å®¢æˆ·ç«¯ å‘é‚®ä»¶åªæœ‰ä¸€ç§æ–¹å¼: SMTP(25)

        å®¢æˆ·ç«¯æ”¶å‘é‚®ä»¶.å…¶å®æœ¬è´¨ä¸Šæ˜¯é€šè¿‡æœåŠ¡å™¨åœ¨å¸®ä½ æ”¶å‘é‚®ä»¶.
        å®¢æˆ·ç«¯é€šè¿‡ä¸€ä¸ªè½¯ä»¶å¦‚Outlook å°±å¯ä»¥è¿æ¥åˆ°æœåŠ¡å™¨.è®©æœåŠ¡å™¨å¸®ä½ å‘é‚®ä»¶.è¿˜å¯ä»¥ä»æœåŠ¡å™¨ä¸‹è½½æ”¶åˆ°çš„é‚®ä»¶.

        ğŸ“Œ IMAPã€POP3   â—ï¸â—ï¸æ¥æ”¶é‚®ä»¶çš„å¸¸ç”¨åè®®. æ³¨æ„æ˜¯æ¥æ”¶.ä¸æ˜¯å‘é€â—ï¸â—ï¸
                IMAP: Internet Message Access Protocol
                POP3: Post Office Protocol - Version 3

                POP3 å’Œ IMAP æ˜¯ä¸¤ç§æ¥æ”¶æ–¹å¼.
                    ğŸ“Œ POP3 æœ¬åœ°å®¢æˆ·ç«¯æŠŠé‚®ä»¶ä»æœåŠ¡å™¨ä¸‹è½½ä¸‹æ¥!
                            æ‰€æœ‰æ“ä½œéƒ½åœ¨æœ¬åœ°ï¼Œä¸å½±å“æœåŠ¡å™¨ä¸Šä¿å­˜çš„é‚®ä»¶ã€‚

                    ğŸ“Œ IMAP æœ¬åœ°å®¢æˆ·ç«¯ç›´æ¥å¯¹æœåŠ¡å™¨ä¸Šçš„é‚®ä»¶è¿›è¡Œç®¡ç†æ“ä½œ!!!!
                            IMAPçš„ä¸»è¦ä¼˜åŠ¿åœ¨äºå®¢æˆ·ç«¯çš„æ‰€æœ‰æ“ä½œéƒ½ä¸é‚®ä»¶æœåŠ¡å™¨åŒæ­¥ï¼Œç”¨æˆ·ä½“éªŒæ›´å¥½ã€‚

        ğŸ“Œ SMTP
                SMTP(Simple Mail Transfer Protocol)æ˜¯å‘é€é‚®ä»¶çš„æ ‡å‡†åè®®ï¼Œ



â¤ï¸ å‘é€é‚®ä»¶æµç¨‹:

    æœ¬åœ°å®¢æˆ·ç«¯ Outlook. æƒ³è¦å‘é€ä¸€ä¸ªé‚®ä»¶ç»™ xx2610@gmail.com è¿™ä¸ªäºº.
    å¾—å…ˆå’Œé‚®ä»¶æœåŠ¡å™¨ä¸Šçš„ Postfix é€šä¿¡. è®©Postfixå¸®ä½ å‘é‚®ä»¶. è¿™ä¸ªé€šä¿¡å°±éœ€è¦ç”¨åˆ° SMTP åè®®.(å‘é€é‚®ä»¶çš„åè®®.)

    xx2610@gmail.com æ˜¯ä¸ªgmailé‚®ç®±.æ‰€æœ‰å‘ç»™gmail.comåç¼€çš„é‚®ä»¶. éƒ½æ˜¯å‘ç»™ gamil é‚®ç®±æœåŠ¡å™¨çš„.
    æˆ‘ä»¬éœ€è¦çŸ¥é“ gmail.com è¿™ä¸ªé‚®ç®±æœåŠ¡å™¨çš„IPåœ°å€. å°±éœ€è¦é€šè¿‡DNSæœåŠ¡å™¨æŸ¥è¯¢ MXè®°å½•äº†.

    æœ‰äº†å¯¹æ–¹çš„IPåœ°å€. æ¥ä¸‹æ¥å°±æ˜¯  æˆ‘çš„Postfixé‚®ä»¶æœåŠ¡å™¨ å’Œ gmailçš„Postfixé‚®ä»¶æœåŠ¡å™¨ ä¹‹é—´çš„é€šä¿¡äº†.
    æˆ‘çš„é‚®ä»¶æœåŠ¡å™¨ è¦ç»™ å¯¹æ–¹æœåŠ¡å™¨å‘é€é‚®ä»¶. ä¹Ÿæ˜¯é€šè¿‡SMTPè¿™ä¸ªåè®®æ¥çš„.

    å¯¹æ–¹é‚®ä»¶æœåŠ¡å™¨é¦–å…ˆé€šè¿‡Postfixæ¥æ”¶é‚®ä»¶.  
    ç„¶åé€šè¿‡procmail æŠŠé‚®ä»¶ä¿å­˜åˆ°æœåŠ¡å™¨ç¡¬ç›˜.é»˜è®¤ä¿å­˜è·¯å¾„: /var/spool/mail/usernameã€‚

    å¯¹æ–¹æœåŠ¡å™¨çš„å·¥ä½œå°±å·®ä¸å¤šå®Œæˆäº†.
    æ¥ä¸‹æ¥å°±æ˜¯å¯¹æ–¹å®¢æˆ·ç«¯ Outlook çš„å·¥ä½œäº†.
    Outlook æ˜¯æœ‰ä¸ªæ—¶é—´è®¾ç½®çš„!!! æ¯éš”å‡ åˆ†é’Ÿå°±é—®ä¸€ä¸‹æœåŠ¡å™¨ä¸Šçš„ Dovecot æœ‰æ²¡æœ‰å‘ç»™è‡ªå·±çš„é‚®ä»¶.
    å¦‚æœæœ‰çš„è¯. ä¸‹é¢å°±æ˜¯ å®¢æˆ·ç«¯Outlook å’Œ Dovecot ä¹‹é—´çš„é€šä¿¡äº†.
    å®¢æˆ·ç«¯å¯ä»¥é€‰æ‹©ç”¨POP3åè®®. æ¯æ¬¡ä¸‹è½½æœåŠ¡å™¨ä¸Šçš„é‚®ä»¶. æœ¬åœ°åˆ é™¤äº†æœåŠ¡å™¨ä¸Šçš„é‚®ä»¶è¿˜æ˜¯åœ¨çš„.
    å®¢æˆ·ç«¯å¦‚æœé€‰æ‹©ç”¨IMAPåè®®. æ¯æ¬¡æ“ä½œéƒ½ä¼šåŒæ­¥åˆ°æœåŠ¡å™¨.æœ¬åœ°åˆ é™¤äº†æœåŠ¡å™¨ä¸Šä¹Ÿå°±åˆ é™¤äº†.

    å¤§æ¦‚æµç¨‹å°±æ˜¯è¿™ä¹ˆç®€å•....





â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸
â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸


â¤ï¸ é›¶: æœåŠ¡å™¨ä¸»æœºåè®¾ç½®

         â—ï¸â—ï¸â—ï¸â—ï¸â—ï¸â—ï¸ä¸»æœºåå¿…é¡»è¦æ”¹æˆ mail.0214.help â—ï¸â—ï¸â—ï¸â—ï¸â—ï¸â—ï¸
         â—ï¸â—ï¸â—ï¸â—ï¸â—ï¸â—ï¸ä¸»æœºåå¿…é¡»è¦æ”¹æˆ mail.0214.help â—ï¸â—ï¸â—ï¸â—ï¸â—ï¸â—ï¸

    é‚®ç®±è®¾ç½®ç¬¬ä¸€ä¸ªè¦ä½ å¡«çš„å°±æ˜¯hostnameå•Š!! è¿™ä¸ªå°±æ˜¯æœåŠ¡å™¨çš„ä¸»æœºåå•Š
      
      ğŸ”¸ vps æ§åˆ¶é¢æ¿ä¸­å¯ä»¥ç›´æ¥æ”¹.

      ğŸ”¸ æˆ–è€…æ‰‹åŠ¨ä¿®æ”¹ /etc/hosts å’Œ /etc/sysconfig/network ä¸¤ä¸ªæ–‡ä»¶ä¸‹ç›¸å…³é…ç½®å³å¯ã€‚
            âœ  ~ cat /etc/hosts
            127.0.0.1 localhost.localdomain localhost
            # Auto-generated hostname. Please do not remove this comment.
            23.105.192.96 mail.0214.help  mail
            ::1         localhost localhost.localdomain localhost6 localhost6.localdomain6
            âœ  ~ cat /etc/sysconfig/network
            NETWORKING="yes"
            GATEWAYDEV="venet0"
            NETWORKING_IPV6="yes"
            IPV6_DEFAULTDEV="venet0"
            HOSTNAME="mail.0214.help"
            âœ  ~ Timeout, server 23.105.192.96 not responding.




â¤ï¸ ä¸€: åŸŸåè§£æ:

      ğŸ”¸ æ·»åŠ Aè®°å½•  æŠŠwww.0214.help  ç»‘å®šåˆ° æœåŠ¡å™¨IP: 23.105.192.96
        A www 23.105.192.96
        è¿™ä¸ªä¸€èˆ¬éƒ½å·²ç»è®¾ç½®è¿‡çš„. ä¸»è¦å°±æ˜¯ä¸‹é¢ä¸¤ä¸ª.

      ğŸ”¸ æ·»åŠ Aè®°å½• æŠŠmail.0214.help ç»‘å®šåˆ° æœåŠ¡å™¨IP: 23.105.192.96
        A mail 23.105.192.96
            è®°å½•ç±»å‹: A
            ä¸»æœºè®°å½•: mail
            è®°å½•å€¼: ipåœ°å€

      ğŸ”¸ æ·»åŠ MXè®°å½• 
        MX @ mail.0214.help
            è®°å½•ç±»å‹: MX
            è¿™é‡Œä¸»æœºæ˜¯@ æˆ–è€…ç•™ç©º.
            è®°å½•å€¼æ˜¯ mail.0214.help
            // å…¶å®è¿™ä¸ªè®°å½•å€¼ å°±æ˜¯ç¬¬äºŒä¸ªAè®°å½•é‡Œçš„ äºŒçº§åŸŸå...


        MXè®°å½•: Mail eXchange.
        ä¼˜å…ˆçº§: æ•°å­—è¶Šå°ä¼˜å…ˆçº§è¶Šé«˜. é»˜è®¤1 .

        DNS ç”Ÿæ•ˆ(æ‰©æ•£åˆ°å…¨çƒ)éœ€è¦æ—¶é—´.
            https://www.whatsmydns.net/#MX/www.0214.help    è¿™ä¸ªç½‘ç«™å¯ä»¥æŸ¥çœ‹æ‰©æ•£æƒ…å†µ
            ç½‘å€: 0214.help ã€ç±»å‹é€‰æ‹©MX æœç´¢å°±å¯ä»¥äº†..
            ç½‘ç«™åƒä¸‡åˆ«å†™ www.0214.help æˆ–è€… mail.0214.help


      ğŸ”¸ çœ‹é‚®ç®±çš„åŸŸåè§£ææ˜¯å¦æ­£ç¡®.

          ğŸ”… dig 0214.help mx
          ;; QUESTION SECTION:
          ;0214.help.			IN	MX

          ;; ANSWER SECTION:
          0214.help.		300	IN	MX	1 mail.0214.help.
          // æœ‰è¿™è¡Œå‡ºç°å°±è¯´æ˜å¯¹äº†....




â¤ï¸ äºŒ: å¸è½½ Sendmail
      // ä¸€å±±ä¸å®¹äºŒè™. è‡ªå¸¦çš„sendmail ä¼šå½±å“postfix.
    ğŸ”… service sendmail status/start/stop    æŸ¥çœ‹/å¯åŠ¨/åœæ­¢ sendmail
    ğŸ”… yum remove sendmail                   å¸è½½ sendmail æœåŠ¡ (å…ˆåœæ­¢)


â¤ï¸ ä¸‰: å®‰è£…

    å®‰è£… postfix    ğŸ”… yum -y install postfix   é»˜è®¤å®‰è£… 2.6.6 ç‰ˆ.
    å®‰è£… dovecot    ğŸ”… yum install -y dovecot
    å®‰è£… procmail   ğŸ”… yum install procmail
    å®‰è£… cycus-sasl ğŸ”… yum install cyrus-sasl cyrus-imapd
        æŸ¥çœ‹æ˜¯å¦å®‰è£…cycus-sasl:  rpm -qa |grep cyrus-sasl



â¤ï¸ å››: ä¿®æ”¹é»˜è®¤é‚®ä»¶ä¼ è¾“ä»£ç† MTA
  ğŸ”… alternatives --config mta    ç„¶åæŒ‰å›è½¦å°±å¯ä»¥äº†.
        âœ  ~ alternatives --config mta

        There is 1 program that provides 'mta'.

          Selection    Command
        -----------------------------------------------
        *+ 1           /usr/sbin/sendmail.postfix

        Enter to keep the current selection[+], or type selection number:


  ğŸ”… alternatives --display mta  æŸ¥çœ‹æ˜¯å¦è®¾ç½®æˆåŠŸ:
        å‡ºç°ä¸‹é¢çš„å°±å¯¹äº†. æ„æ€å°±æ˜¯ mta ç°åœ¨æ˜¯æ‰‹åŠ¨è®¾å®šçš„.ä¸æ˜¯è‡ªåŠ¨çš„.
        æ‰‹åŠ¨è®¾ç½®çš„è·¯å¾„æ˜¯ xxx.postfix.
        âœ  ~ alternatives --display mta
        mta - status is manual.
        link currently points to /usr/sbin/sendmail.postfix




â¤ï¸ äº”: é…ç½® Postfix   vi /etc/postfix/main.cf


    ğŸ”¸ 75è¡Œ: å–æ¶ˆæ³¨é‡Šï¼Œå¹¶è®¾ç½®ä½ è‡ªå·±çš„
    myhostname = mail.0214.help

    ğŸ”¸ 83è¡Œ: å–æ¶ˆæ³¨é‡Šï¼Œè®¾ç½®åŸŸå
    mydomain = 0214.help
    // é‚®ä»¶æœåŠ¡å™¨çš„åŸŸå.å¯ä»¥æ˜¯çœŸå®çš„ ä¹Ÿå¯ä»¥æ˜¯è™šæ„çš„..

    ğŸ”¸ 99è¡Œ: å–æ¶ˆæ³¨é‡Š.
    myorigin = $mydomain
    // æœ¬æœºé‚®ä»¶å‘é€æ—¶å€™ ç”¨çš„åŸŸå..


    ğŸ”¸ 116è¡Œ: ä¿®æ”¹
    inet_interfaces = all
    // é»˜è®¤åªç›‘å¬æœ¬åœ°ç¯å›æ¥å£(localhost)ï¼Œ æ”¹æˆ all è®©Postfixç›‘å¬æ•´ä¸ªäº’è”ç½‘.


    ğŸ”¸ 119è¡Œ: æ¨èipv4ï¼Œå¦‚æœæ”¯æŒipv6ï¼Œåˆ™å¯ä»¥ä¸ºall
    inet_protocols = ipv4


    ğŸ”¸ 164è¡Œ: æ·»åŠ 
    mydestination = $myhostname, localhost.$mydomain, localhost, $mydomain
    // å¯ä»¥æŠ•é€’çš„ç½‘ç»œ.è¿™å°æœåŠ¡å™¨æ˜¯å¯„å¾€è¿™äº›ç½‘åŸŸçš„é‚®ä»¶çš„æœ€ç»ˆç›®çš„åœ°


    ğŸ”¸ Postfix é»˜è®¤ä¸»æœºå:
    ğŸ“Œmydestination = $myhostname, localhost.$mydomain,localhost
    //æ‰€æœ‰å‘é‚®ä»¶æ—¶ä½¿ç”¨ä»£è¡¨æœ¬æœºçš„ä¸»æœºåå¿…é¡»åœ¨æ­¤åˆ—å‡ºï¼Œå¦åˆ™æ— æ³•æ¥æ”¶é‚®ä»¶ã€‚





    ğŸ”¸ 264è¡Œ: å–æ¶ˆæ³¨é‡Šï¼ŒæŒ‡å®šå†…ç½‘å’Œæœ¬åœ°çš„IPåœ°å€èŒƒå›´
        mynetworks = 127.0.0.0/8, 10.0.0.0/8,01.92.192.0/20
        è¿™æ˜¯è·ä¿¡ä»»å¯ä»¥é€šè¿‡æœåŠ¡å™¨æ¥å‘æ”¾æˆ–è½¬å‘é‚®ä»¶çš„ IP åœ°å€ã€‚
        å½“æ¥è‡ªè¿™äº› IP åœ°å€ä»¥å¤–çš„ç”¨æˆ·å°è¯•é€šè¿‡æœåŠ¡å™¨å‘æ”¾é‚®ä»¶æ—¶ï¼Œä¾¿ä¼šè¢«æ‹’ç»ã€‚
        è¿™ä¸ªå°±æ˜¯ä½  æœ¬åœ°ç”µè„‘çš„ç½‘æ®µäº†!!!
          æ¯”å¦‚çˆ±ä¸Šæµ·
          IPæ˜¯    101.92.200.133
          æ©ç æ˜¯:    255.255.240.0
        å°±èƒ½ç®—å‡ºæœ¬åœ°çš„ç½‘æ®µâ†’ 101.92.192.0/20
        æŠŠè¿™ä¸ªç½‘æ–­åŠ åˆ°mynetworksé‡Œé¢å°±å¯ä»¥äº†

        æˆ–è€…è®¾ç½®æˆ 0.0.0.0/0 è¿™ä¸ªæ˜¯æ•´ä¸ªäº’è”ç½‘äº†. æˆ‘æ˜¯æ²¡æœ‰æµ‹è¯•è¿‡....


    ğŸ”¸ relay_domains =
        å¯é€‰.
        è¿™æ˜¯æœ¬ç³»ç»Ÿä¼šæŠŠé‚®ä»¶è½¬å¯„åˆ°çš„ç½‘åŸŸçš„æ¸…å•ã€‚é€šè¿‡å°†å®ƒè®¾ç½®ä¸ºç©ºç™½ï¼Œæˆ‘ä»¬ç¡®ä¿è¿™å°é‚®ä»¶æœåŠ¡å™¨ä¸ä¼šæˆä¸ºæœªå—ä¿¡ä»»çš„ç½‘ç»œçš„å…¬å¼€è½¬å‘ç«™ã€‚



    ğŸ”¸ 419è¡Œ: å–æ¶ˆæ³¨é‡Šï¼Œé‚®ä»¶ä¿å­˜ç›®å½•
    home_mailbox = Maildir/
        å®ƒè®¾ç½®ä¿¡ç®±ç›¸å¯¹ç”¨æˆ·æ ¹ç›®å½•çš„è·¯å¾„ï¼Œä»¥åŠæŒ‡å®šè¦é‡‡ç”¨çš„ä¿¡ç®±æ ¼å¼ã€‚postfix åŒæ—¶æ”¯æŒ Maildir åŠ mbox æ ¼å¼ï¼Œ    


    ğŸ”¸ 571è¡Œ: æ·»åŠ 
        smtpd_banner = $myhostname ESMTP

        # æ·»åŠ åˆ°æœ€å
        # è§„å®šé‚®ä»¶æœ€å¤§å°ºå¯¸ä¸º10M
        message_size_limit = 10485760
        # è§„å®šæ”¶ä»¶ç®±æœ€å¤§å®¹é‡ä¸º1G
        mailbox_size_limit = 1073741824
        # SMTPè®¤è¯
        smtpd_sasl_type = dovecot
        smtpd_sasl_path = private/auth
        smtpd_sasl_auth_enable = yes
        smtpd_sasl_security_options = noanonymous
        smtpd_sasl_local_domain = $myhostname
        smtpd_recipient_restrictions=permit_mynetworks,permit_auth_destination,permit_sasl_authenticated,reject





â¤ï¸ å…­: é…ç½®dovecot    è·¯å¾„: /etc/dovecot/


  ğŸ”¸ vi /etc/dovecot/dovecot.conf
      protocols = imap pop3
      listen = *
      # 26è¡Œ: å¦‚æœä¸ä½¿ç”¨IPv6ï¼Œå…ˆå»æ‰æ³¨é‡Šç„¶å. è¯·ä¿®æ”¹ä¸º* .
      # åè®®ç”¨ pop3 å’Œ imap å°±å¯ä»¥äº† .ä¹Ÿè¦å»æ‰æ³¨é‡Š.
      æŒ‡å®šå¯ä¾›ç”¨æˆ·è®¿é—®é‚®ä»¶çš„åè®®ã€‚


  ğŸ”¸ vi /etc/dovecot/conf.d/10-auth.conf
      # 9è¡Œ: å–æ¶ˆæ³¨é‡Šå¹¶ä¿®æ”¹
      disable_plaintext_auth = no

      # 97è¡Œ: 
      auth_mechanisms = plain login


  ğŸ”¸ vim /etc/dovecot/conf.d/10-mail.conf
      # 30è¡Œ: å–æ¶ˆæ³¨é‡Šå¹¶ä¿®æ”¹æˆ
      mail_location = maildir:~/Maildir


  ğŸ”¸ vim /etc/dovecot/conf.d/10-master.conf

      # Postfix smtp-auth
      #unix_listener /var/spool/postfix/private/auth {
      #  mode = 0666
      #}

      æ”¹æˆä¸‹é¢çš„:
      unix_listener /var/spool/postfix/private/auth {
                            mode = 0666 
                            user = postfix 
                            group = postfix
    }







â¤ï¸ ä¸ƒ: é…ç½®sasl2

    vim /etc/sysconfig/saslauthd
    MECH=shadow  #æŒ‡å®šä»¥æœ¬åœ°ç³»ç»Ÿç”¨æˆ·åè®¤è¯


    vim /usr/lib64/sas12/smtpd.conf    //64ä½ç³»ç»Ÿ
    vim /usr/lib/sas12/smtpd.conf       //32ä½ç³»ç»Ÿ
      pwcheck_method: saslauthd
      mech_list: PLAIN LOGIN
      log_level:3






â¤ï¸ å…«:å¯åŠ¨/åœæ­¢ 

    å¯åŠ¨ postfix ,dovecot ,saslauthd æœåŠ¡
        service postfix start
        service dovecot start
        service saslauthd start


    åœæ­¢ postfix ,dovecot ,saslauthd æœåŠ¡
        service postfix stop
        service dovecot stop
        service saslauthd stop


    çŠ¶æ€ postfix ,dovecot ,saslauthd æœåŠ¡
        service postfix status
        service dovecot status
        service saslauthd status


        æ³¨æ„: centOS 7ä¸‹å°†ä¸å†ä½¿ç”¨ service æ¥å¯åŠ¨æœåŠ¡,è€Œæ˜¯è·³è½¬åˆ° systemctl æŒ‡ä»¤ä¸‹.
        systemctl  start  dovecotã€systemctl  start  postfixã€systemctl  start  saslauthd



        ğŸ”¸ å¯åŠ¨dovecotï¼Œä½¿ç”¨å¦‚ä¸‹å‘½ä»¤ï¼š

            /etc/init.d/dovecot start
            chkconfig dovecot on
            /etc/init.d/portreserve stop
            chkconfig portreserve off

            æ³¨æ„ï¼šä¸Šè¿°å‘½ä»¤ä¸­çš„portreserveæœåŠ¡ç›¸å…³çš„ä¸¤è¡Œï¼Œ
            è¿™ä¸ªå¦‚æœå¯åŠ¨çš„è¯ï¼Œä½ ä¼šå‘ç°ç³»ç»Ÿé‡å¯ådovecotä¼šæ— æ³•å¯åŠ¨ï¼Œ
            è¿™æ˜¯å› ä¸ºportreserveå ç”¨äº†dovecotçš„ç«¯å£ï¼Œæ‰€ä»¥åœ¨æ­¤æˆ‘ä»¬ç¦ç”¨portreserveæœåŠ¡



â¤ï¸ ä¹: åˆ›å»ºå¸å·
    // æ³¨æ„æœåŠ¡å™¨å¸å· å°±æ˜¯é‚®ç®±å¸å·!
    // å½“ç„¶ä¸ºäº†å®‰å…¨ä½ å¯ä»¥è®©å¸å·åªèƒ½ä½¿ç”¨é‚®ç®±,è€Œä¸èƒ½ç™»å½•æœåŠ¡å™¨

    æ·»åŠ è´¦æˆ· admin
    ğŸ”… useradd admin

    ä¸ºå¸å· admin åˆ›å»ºå¯†ç 
    ğŸ”… passwd admin

    åˆ›å»ºå¥½åå°±æœ‰äº† admin@0214.help è¿™ä¸ªé‚®ç®±å¸å·äº†!!




â¤ï¸ å: é…ç½®å®¢æˆ·ç«¯:

      hostname: mail.0214.help
      username: xujian
      // è¿™é‡Œæ³¨æ„ æ˜¯ xujian ä¸æ˜¯ xujian@0214.help
      auth method: login
      è®¾ç½®å°±é‚£ä¹ˆå‡ ä¸ªé€‰é¡¹ å¤šè¯•å‡ æ¬¡å°±å¯ä»¥äº†.
      å¦‚æœè¿›å»äº†, é‚£ä¹ˆå°±æ­å–œäº†. å‡ ä¹å®Œæˆäº†.
      ä¸‹é¢å‘é€æ¥æ”¶ä¸‹é‚®ä»¶å°±å¯ä»¥äº†.
      æ³¨æ„ä½ å‘å‡ºå»çš„é‚®ä»¶ æ˜¯ä¸æ˜¯åˆ°å¯¹æ–¹çš„åƒåœ¾é‚®ä»¶é‡Œå°±å¯ä»¥äº†.





â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸â¬›ï¸

â¤ï¸ é—®é¢˜æ’æŸ¥ æ­å»ºè¿‡ç¨‹æ€»ä¼šé‡åˆ°å„ç§é—®é¢˜çš„. ä¸‹é¢æ˜¯ä¸€äº›æ€è·¯.


  ğŸ”µ é‡å¯Postfix     service postfix restart

  ğŸ”µ æŸ¥ 25 ç«¯å£æ˜¯å¦å¼€å¯ 
    âœ  ~ netstat -antp |grep :25
    tcp        0      0 127.0.0.1:25                0.0.0.0:*                   LISTEN      1021/master
      çœ‹åˆ°æ²¡ 25ç«¯å£å‰é¢æ˜¯ 127.0.0.1 
      è¯´æ˜åªå¼€æ”¾æœ¬åœ°!!   å˜æˆ 0.0.0.0 æ‰æ˜¯å…¨çƒå¼€æ”¾çš„.
      
      vi /etc/postfix/main.cf

      inet_interfaces = all
      inet_interfaces = localhost
      æœç´¢è®¾ç½®ç«¯å£çš„å‚æ•°. å‘ç°å±…ç„¶æœ‰ä¸¤ä¸ª  inet_interfaces è®¾ç½®. 
      æ–‡ä»¶æ˜¯æŒ‰ç…§ä»ä¸Šå¾€ä¸‹æ¥çš„. æœ€åçš„ç»“æ„å°±æ˜¯ inet_interfaces = localhost
      åˆ é™¤ localhostè¡Œå°±å¥½äº†.
      ç„¶åå†é‡å¯ postfix 
      å†çœ‹çœ‹25ç«¯å£æ˜¯ä¸æ˜¯æ­£å¸¸äº†.
      âœ  ~ netstat -antp |grep :25
      tcp        0      0 0.0.0.0:25                  0.0.0.0:*                   LISTEN      1615/master
      è¿™ä¸‹å°±æ­£å¸¸äº†.



  ğŸ”µæŸ¥çœ‹ 25,110,143 æ˜¯å¦å¼€å¯
    
    ğŸ”¸ å®¢æˆ·ç«¯æ‰«ææœåŠ¡å™¨ç«¯å£ 25 smtp  110 pop3  143 imap æ˜¯å¦å¼€å¯:

      âœ˜âœ˜âˆ™ğ’— Desktop nmap -p 25,110,143 23.105.192.96

      Starting Nmap 7.25BETA1 ( https://nmap.org ) at 2017-04-06 15:45 CST
      Nmap scan report for 23.105.192.96.16clouds.com (23.105.192.96)
      Host is up (0.15s latency).
      PORT    STATE    SERVICE
      25/tcp  open     smtp
      110/tcp filtered pop3
      143/tcp filtered imap

      ğŸ”¸çœ‹åˆ°filtered å°±å»è®¾ç½®æœåŠ¡å™¨çš„é˜²ç«å¢™å¼€æ”¾ç«¯å£.
      âœ  ~ iptables -A INPUT -p tcp --dport 110 -j ACCEPT
      âœ  ~ iptables -A INPUT -p tcp --dport 143 -j ACCEPT


      æ¥ç€æ‰«æ:
        âœ˜âœ˜âˆ™ğ’— Desktop nmap -p 25,110,143 23.105.192.96

        Starting Nmap 7.25BETA1 ( https://nmap.org ) at 2017-04-06 15:47 CST
        Nmap scan report for 23.105.192.96.16clouds.com (23.105.192.96)
        Host is up (0.22s latency).
        PORT    STATE  SERVICE
        25/tcp  open   smtp
        110/tcp closed pop3
        143/tcp closed imap

        Nmap done: 1 IP address (1 host up) scanned in 0.59 seconds
        å‘ç° 110.143 éƒ½æ²¡å¼€... pop3 ä¸ª imap éƒ½æ˜¯ä¸‹è½½é‚®ä»¶çš„.æ˜¯Dovecotçš„äº‹æƒ….  ä¼°è®¡Dovecot æœåŠ¡æ²¡å¼€. 
      
      ğŸ”¸ å¼€å¯æ˜¯DovecotæœåŠ¡    /etc/init.d/dovecot start

        å¼€å®Œæ¥ç€æ‰«æ å‘ç°ç«¯å£éƒ½å¼€äº†.
        âœ˜âœ˜âˆ™ğ’— Desktop nmap -p 25,110,143 23.105.192.96

        Starting Nmap 7.25BETA1 ( https://nmap.org ) at 2017-04-06 15:50 CST
        Nmap scan report for 23.105.192.96.16clouds.com (23.105.192.96)
        Host is up (0.21s latency).
        PORT    STATE SERVICE
        25/tcp  open  smtp
        110/tcp open  pop3
        143/tcp open  imap

        Nmap done: 1 IP address (1 host up) scanned in 0.53 seconds





  ğŸ”µ é…ç½®æ–‡ä»¶ä¸­ æœ¬åœ°å†…ç½‘è®¾ç½®æ˜¯å¦æ­£ç¡®:
      mynetworks = 127.0.0.0/8,10.0.0.0/8,101.92.192.0/20
      
  

  ğŸ”µ å…¨é¢æ‰«ææœåŠ¡å™¨ç«¯å£

      âœ˜âœ˜âˆ™ğ’— Desktop nmap 23.105.192.96

      Starting Nmap 7.25BETA1 ( https://nmap.org ) at 2017-04-05 14:23 CST
      Nmap scan report for 23.105.192.96.16clouds.com (23.105.192.96)
      Host is up (0.18s latency).
      Not shown: 991 filtered ports
      PORT     STATE SERVICE
      80/tcp   open  http
      110/tcp  open  pop3
      143/tcp  open  imap
      993/tcp  open  imaps
      995/tcp  open  pop3s
      1026/tcp open  LSA-or-nterm
      1028/tcp open  unknown
      2222/tcp open  EtherNetIP-1
      3306/tcp open  mysql

      =============
      çœ‹çœ‹..  
      pop3 110ã€pop3s 995
      imap 143ã€imaps 993
      è¿™ä¸¤ä¸ªéƒ½æ˜¯.... å®¢æˆ·ç«¯æ¥æ”¶é‚®ä»¶çš„å•Š..

      25ç«¯å£éƒ½æ²¡å¼€å•Š... è¿™ä¸ªæ˜¯å‘é€é‚®ä»¶çš„....
      å…³é—­æœåŠ¡å™¨é˜²ç«å¢™è¯•è¯•

      Host is up (0.21s latency).
      Not shown: 979 closed ports
      PORT     STATE    SERVICE
      42/tcp   filtered nameserver
      80/tcp   open     http
      110/tcp  open     pop3
      111/tcp  filtered rpcbind
      135/tcp  filtered msrpc
      139/tcp  filtered netbios-ssn
      143/tcp  open     imap
      445/tcp  filtered microsoft-ds
      593/tcp  filtered http-rpc-epmap
      993/tcp  open     imaps
      995/tcp  open     pop3s
      1025/tcp filtered NFS-or-IIS
      1026/tcp open     LSA-or-nterm
      1028/tcp open     unknown
      1068/tcp filtered instl_bootc
      1434/tcp filtered ms-sql-m
      1723/tcp filtered pptp
      2222/tcp open     EtherNetIP-1
      3128/tcp filtered squid-http
      3306/tcp open     mysql
      4444/tcp filtered krb524

      å¤šäº†è¿™ä¹ˆå¤š...   è¿˜æ˜¯æ²¡25å•Š..
      25æ˜¯ä»€ä¹ˆ.....
      25 å°±æ˜¯ ...é‚®ä»¶æœåŠ¡å™¨ å‘é‚®ä»¶çš„ç«¯å£. ä¹Ÿå°±æ˜¯ postfix æ²¡å¯åŠ¨å•Š!!!

      å¦‚æœpostfixå¯åŠ¨äº†,ä½†æ˜¯æ²¡å¤–ç½‘æ²¡å‘ç°25ç«¯å£æ‰“å¼€.
      é‚£å°±è¯´æ˜25ç«¯å£ åªå¯¹æœåŠ¡å™¨æœ¬æœºæœ‰æ•ˆ.
      ä¹Ÿå°±æ˜¯ç«¯å£ç›‘å¬èŒƒå›´è®¾ç½®é—®é¢˜äº†.è‚¯å®šæ˜¯å“ªé‡Œè®¾ç½®äº† localhost.å¯¼è‡´åªå¯¹æœ¬åœ°æœ‰æ•ˆ.






